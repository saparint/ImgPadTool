<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- âœ¨ ì¶”ê°€: ëª¨ë°”ì¼ ë·°í¬íŠ¸ ì„¤ì • âœ¨ -->
  <title>Image Padding Tool</title>
  <style>
    /* 4. box-sizing: border-box; ì „ì—­ ì ìš© */
    * {
      box-sizing: border-box;
    }

    body {
      font-family: sans-serif;
      padding: 1rem;
      background: #111;
      color: #fff;
      min-height: 100vh;
      display: flex; /* âœ¨ ì¶”ê°€: bodyë¥¼ flex ì»¨í…Œì´ë„ˆë¡œ ë§Œë“¤ì–´ ë‚´ë¶€ ìš”ì†Œ ì¤‘ì•™ ì •ë ¬ì„ ë•ìŠµë‹ˆë‹¤. âœ¨ */
      flex-direction: column; /* âœ¨ ì¶”ê°€: ìš”ì†Œë“¤ì„ ì„¸ë¡œë¡œ ì •ë ¬ âœ¨ */
      align-items: center; /* âœ¨ ì¶”ê°€: ìì‹ ìš”ì†Œë“¤ì„ ê°€ë¡œ ì¤‘ì•™ ì •ë ¬ âœ¨ */
    }
    input, select, button {
      margin: 0.5rem 0;
      padding: 0.4rem;
      font-size: 1rem;
    }

    /* âœ¨ ì¶”ê°€: ë©”ì¸ ì½˜í…ì¸  ì»¨í…Œì´ë„ˆ ìŠ¤íƒ€ì¼ âœ¨ */
    #mainContentContainer {
        max-width: 600px; /* ì›í•˜ëŠ” ìµœëŒ€ ë„ˆë¹„ ì„¤ì •, í”½ì…€ ë‹¨ìœ„ë¡œ ì¡°ì • ê°€ëŠ¥ */
        width: 100%; /* ë¶€ëª¨ì— ë§ì¶° ë„ˆë¹„ 100% ì‚¬ìš© (max-widthì— ê±¸ë¦¼) */
        /* margin: 0 auto; /* bodyê°€ flex ì»¨í…Œì´ë„ˆì´ë¯€ë¡œ í•„ìš” ì—†ì–´ì§. */
        padding: 0 0.5rem; /* ì„ íƒ ì‚¬í•­: ì»¨í…Œì´ë„ˆ ë‚´ë¶€ ì¢Œìš° íŒ¨ë”© ì¶”ê°€ (body íŒ¨ë”©ê³¼ ë³„ê°œ) */
    }


    /* 1. <br> íƒœê·¸ ì œê±° í›„ CSSë¡œ ê°„ê²© ì¡°ì ˆ */
    #imageInput {
        margin-bottom: 1rem;
    }

    canvas {
      border: 1px solid #555;
      background-color: #222; /* Default solid background for canvas */
      max-width: 100%;
      max-height: calc(100vh - 250px);
      height: auto;
      display: block;
      margin-top: 1rem;
      /* âœ¨ ìˆ˜ì •: ìº”ë²„ìŠ¤ë„ ì¤‘ì•™ ì •ë ¬ë˜ë„ë¡ margin-left/rightë¥¼ autoë¡œ ë³€ê²½ âœ¨ */
      margin-left: auto;
      margin-right: auto;
      z-index: 5;
    }

    canvas.transparent-background-pattern {
        background-image: linear-gradient(45deg, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%, #ddd),
                          linear-gradient(45deg, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%, #ddd);
        background-size: 14px 14px;
        background-position: 0 0, 7px 7px;
        background-color: #fff; /* Base color for the checkerboard */
    }

    /* ìƒ‰ìƒ ì„ íƒ ê´€ë ¨ ìŠ¤íƒ€ì¼ */
    .color-input-group {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-bottom: 0.5rem;
    }

    .color-picker-wrapper {
      position: relative;
      display: inline-block;
      vertical-align: middle;
    }

    #colorDisplayBox {
      width: 150px;
      height: 30px;
      border: 1px solid #555;
      border-radius: 5px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.9rem;
      color: #eee;
      box-sizing: border-box;
    }

    #colorDisplayBox.transparent-display-box {
        background-image: linear-gradient(45deg, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%, #ddd),
                          linear-gradient(45deg, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%, #ddd);
        background-size: 14px 14px;
        background-position: 0 0, 7px 7px;
        background-color: #fff;
        border: 1px solid #aaa;
    }

    #predefinedColorPalette {
      display: none;
      position: absolute;
      top: calc(100% + 5px);
      left: 50%;
      transform: translateX(-50%);
      width: 260px;
      max-width: calc(100vw - 2rem);
      box-sizing: border-box;

      background-color: #333;
      border: 1px solid #555;
      padding: 10px;
      z-index: 10;
      border-radius: 5px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.3);

      grid-template-columns: repeat(6, 1fr);
      gap: 8px;
      align-content: start;
    }

    #predefinedColorPalette.visible {
      display: grid;
    }

    .color-swatch {
      width: 30px;
      height: 30px;
      border: 1px solid #777;
      cursor: pointer;
      border-radius: 3px;
      transition: transform 0.1s ease-in-out;
    }

    .color-swatch:hover {
      transform: scale(1.1);
    }

    .color-swatch.transparent {
        background-image: linear-gradient(45deg, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%, #ddd),
                          linear-gradient(45deg, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%, #ddd);
        background-size: 14px 14px;
        background-position: 0 0, 7px 7px;
        background-color: #fff;
        border: 1px solid #aaa;
    }

    /* ì§ì ‘ ì…ë ¥ í—¥ìŠ¤ ì½”ë“œ í•„ë“œ ìŠ¤íƒ€ì¼ */
    .color-input-area {
        grid-column: 1 / -1;
        margin-top: 10px;
        display: flex;
        align-items: center;
        gap: 5px;
        justify-content: space-between;
    }
    .color-input-area label {
        white-space: nowrap;
        font-size: 0.9rem;
    }
    .color-input-area input[type="text"] {
        flex-grow: 1;
        background-color: #222;
        border: 1px solid #555;
        color: #eee;
        padding: 0.4rem 0.8rem;
        border-radius: 3px;
        font-family: monospace;
        text-transform: uppercase;
        min-width: 0; /* âœ¨ìˆ˜ì •ë¨: íŠ€ì–´ë‚˜ì˜¤ëŠ” ë¬¸ì œ í•´ê²°ì„ ìœ„í•´ ì¶”ê°€ âœ¨*/
    }
    .color-input-area input[type="text"].invalid {
        border-color: #f00;
    }

    /* ë¹„ìœ¨ ì»¨íŠ¸ë¡¤ ê·¸ë£¹ ìŠ¤íƒ€ì¼ */
    .ratio-controls-flex-group {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-bottom: 1rem; /* 1. <br> íƒœê·¸ ì œê±° í›„ CSSë¡œ ê°„ê²© ì¡°ì ˆ */
    }

    /* ë¹„ìœ¨ ì§ì ‘ ì…ë ¥ í•„ë“œ ì»¨í…Œì´ë„ˆ ìŠ¤íƒ€ì¼ */
    .aspect-ratio-custom-input-group {
        display: none;
        align-items: center;
        gap: 5px;
    }
    .aspect-ratio-custom-input-group.visible {
        display: flex;
    }
    .aspect-ratio-custom-input-group label {
        white-space: nowrap;
        font-size: 0.9rem;
    }
    .aspect-ratio-custom-input-group input[type="text"] {
        width: 150px;
        background-color: #222;
        border: 1px solid #555;
        color: #eee;
        padding: 0.4rem 0.8rem;
        border-radius: 3px;
        font-family: monospace;
        box-sizing: border-box;
    }
    .aspect-ratio-custom-input-group input[type="text"].invalid {
        border-color: #f00;
    }

    #eyedropperButton {
        background-color: #555;
        color: #fff;
        border: none;
        border-radius: 5px;
        padding: 0.6rem 0.8rem;
        cursor: pointer;
        transition: background-color 0.2s;
    }

    #eyedropperButton:hover {
        background-color: #777;
    }
    #eyedropperButton:disabled {
        background-color: #333;
        color: #888;
        cursor: not-allowed;
    }

    /* 1. <br> íƒœê·¸ ì œê±° í›„ CSSë¡œ ê°„ê²© ì¡°ì ˆ */
    #downloadButton {
      margin-bottom: 1rem;
    }

    /* --- ëª¨ë°”ì¼ ëŒ€ì‘ì„ ìœ„í•œ ë¯¸ë””ì–´ ì¿¼ë¦¬ ì¶”ê°€ --- */

    /* ì‘ì€ í™”ë©´ (ì˜ˆ: 768px ì´í•˜, íƒœë¸”ë¦¿ ì„¸ë¡œ ë° ìŠ¤ë§ˆíŠ¸í° ê°€ë¡œ/ì„¸ë¡œ) */
    @media (max-width: 768px) {
        body {
            padding: 0.8rem; /* ëª¨ë°”ì¼ì—ì„œ ì¢Œìš° íŒ¨ë”©ì„ ì•½ê°„ ì¤„ì—¬ ê³µê°„ í™•ë³´ */
        }

        h1 {
            font-size: 1.8rem; /* ì œëª© í¬ê¸° ì¤„ì´ê¸° */
            margin-bottom: 1rem;
        }

        /* í”Œë ‰ìŠ¤ ì»¨í…Œì´ë„ˆ ë‚´ë¶€ ìš”ì†Œë“¤ì´ ìë™ìœ¼ë¡œ ë‹¤ìŒ ì¤„ë¡œ ë‚´ë ¤ì˜¤ë„ë¡ ì„¤ì • */
        .color-input-group,
        .ratio-controls-flex-group,
        .aspect-ratio-custom-input-group,
        .color-input-area {
            flex-wrap: wrap; /* ê³µê°„ì´ ë¶€ì¡±í•˜ë©´ ë‹¤ìŒ ì¤„ë¡œ ë„˜ì–´ê°€ë„ë¡ ì„¤ì • */
            gap: 8px; /* ìš”ì†Œ ê°„ ê°„ê²© ì¡°ì • */
        }

        /* ìƒ‰ìƒ ì§ì ‘ ì…ë ¥ í•„ë“œì™€ ë¼ë²¨ì´ í•œ ì¤„ì— ë‹¤ ì•ˆ ë“¤ì–´ê°ˆ ê²½ìš°ë¥¼ ëŒ€ë¹„ */
        .color-input-area label {
            flex-basis: 100%; /* ë¼ë²¨ì´ í•œ ì¤„ ì „ì²´ë¥¼ ì°¨ì§€í•˜ê²Œ í•˜ì—¬ ì…ë ¥ í•„ë“œê°€ ë‹¤ìŒ ì¤„ë¡œ ë‚´ë ¤ì˜¤ë„ë¡ */
            text-align: left; /* ë¼ë²¨ ì •ë ¬ */
        }
        .color-input-area input[type="text"] {
            flex-grow: 1; /* ì…ë ¥ í•„ë“œê°€ ë‚¨ì€ ê³µê°„ì„ ì±„ìš°ë„ë¡ */
            min-width: 150px; /* ë„ˆë¬´ ì‘ì•„ì§€ì§€ ì•Šê²Œ ìµœì†Œ ë„ˆë¹„ ì„¤ì • */
        }


        /* ì‚¬ì „ ì •ì˜ëœ ìƒ‰ìƒ íŒ”ë ˆíŠ¸ì˜ ê·¸ë¦¬ë“œ ì»¬ëŸ¼ ìˆ˜ë¥¼ ì¤„ì—¬ì„œ ëª¨ë°”ì¼ì— ë§ì¶¤ */
        #predefinedColorPalette {
            grid-template-columns: repeat(4, 1fr); /* 6ì—´ -> 4ì—´ ë˜ëŠ” 3ì—´ë¡œ ì¤„ì´ê¸° */
            width: auto; /* ê³ ì • ë„ˆë¹„ ëŒ€ì‹  ìë™ìœ¼ë¡œ ë„ˆë¹„ ì¡°ì ˆ */
            max-width: calc(100vw - 1.6rem); /* body padding ê³ ë ¤ (0.8rem * 2) */
            left: 0; /* ì¤‘ì•™ ì •ë ¬ ëŒ€ì‹  ì™¼ìª½ ì •ë ¬ */
            transform: translateX(0); /* translateX ì´ˆê¸°í™” */
        }
        /* íŒ”ë ˆíŠ¸ê°€ í™”ë©´ ì¤‘ì•™ì´ ì•„ë‹Œ ì¢Œì¸¡ì— ë§ì¶°ì§€ë„ë¡ ì¡°ì • (color-picker-wrapper ê¸°ì¤€ìœ¼ë¡œ) */
        .color-picker-wrapper #predefinedColorPalette {
            left: 0;
            transform: translateX(0);
        }

        /* ìŠ¤ì™€ì¹˜ í¬ê¸°ëŠ” í˜„ì¬ 30pxë¡œ ì¶©ë¶„íˆ í„°ì¹˜í•˜ê¸° ì¢‹ìŠµë‹ˆë‹¤. */

        /* ì‚¬ìš©ì ì •ì˜ ë¹„ìœ¨ ì…ë ¥ í•„ë“œ ë„ˆë¹„ ì¡°ì ˆ */
        #customAspectRatioInputGroup input[type="text"] {
            width: 100%; /* ë¶€ëª¨ ì»¨í…Œì´ë„ˆ ë‚´ì—ì„œ ê°€ë“ ì±„ìš°ë„ë¡ */
            min-width: 150px; /* ë„ˆë¬´ ì‘ì•„ì§€ì§€ ì•Šê²Œ ìµœì†Œ ë„ˆë¹„ */
        }

        /* ìº”ë²„ìŠ¤ */
        canvas {
            max-width: 100%; /* ëª¨ë°”ì¼ì—ì„œ ìº”ë²„ìŠ¤ê°€ í™”ë©´ ë„ˆë¹„ë¥¼ ìµœëŒ€í•œ í™œìš©í•˜ë„ë¡ */
            max-height: calc(100vh - 300px); /* ì»¨íŠ¸ë¡¤ë“¤ì´ ì°¨ì§€í•˜ëŠ” ê³µê°„ì„ ê³ ë ¤í•˜ì—¬ ë†’ì´ ì¡°ì • */
            margin-left: auto; /* ì¤‘ì•™ ì •ë ¬ */
            margin-right: auto; /* ì¤‘ì•™ ì •ë ¬ */
        }

        /* ë²„íŠ¼ê³¼ ì…ë ¥ í•„ë“œì˜ í„°ì¹˜ ì˜ì—­ í™•ë³´ */
        input, select, button {
            min-height: 40px; /* í„°ì¹˜í•˜ê¸° ì‰½ë„ë¡ ìµœì†Œ ë†’ì´ ì„¤ì • */
        }
    }

    /* ì•„ì£¼ ì‘ì€ í™”ë©´ (ì˜ˆ: 480px ì´í•˜, ëŒ€ë¶€ë¶„ì˜ ìŠ¤ë§ˆíŠ¸í° ì„¸ë¡œ) */
    @media (max-width: 480px) {
        body {
            padding: 0.5rem; /* ë” ì‘ì€ í™”ë©´ì—ì„œëŠ” íŒ¨ë”©ì„ ë” ì¤„ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. */
        }

        h1 {
            font-size: 1.6rem;
        }

        /* ìƒ‰ìƒ íŒ”ë ˆíŠ¸ ì»¬ëŸ¼ ë” ì¤„ì´ê¸° */
        #predefinedColorPalette {
            grid-template-columns: repeat(3, 1fr); /* 4ì—´ -> 3ì—´ë¡œ ì¤„ì´ê¸° */
            max-width: calc(100vw - 1rem); /* body padding ê³ ë ¤ (0.5rem * 2) */
        }

        /* 'ì§ì ‘ ì…ë ¥' ë¼ë²¨ì´ ë„ˆë¬´ ê¸¸ë‹¤ë©´ */
        .color-input-area label {
            font-size: 0.85rem;
        }
    }
  </style>
</head>
<body>
  <!-- âœ¨ ì¶”ê°€: ë©”ì¸ ì½˜í…ì¸  ì»¨í…Œì´ë„ˆ ì‹œì‘ âœ¨ -->
  <div id="mainContentContainer">
    <h1 id="mainTitle">ğŸ“ Image Padding Tool</h1>

    <input type="file" id="imageInput" accept="image/*">

    <div class="color-input-group">
      <label for="colorDisplayBox" id="bgColorLabel">ë°°ê²½ìƒ‰:</label>
      <div class="color-picker-wrapper">
        <div id="colorDisplayBox">
          <span id="currentHex">#000000</span>
        </div>
        <div id="predefinedColorPalette">
          <!-- íˆ¬ëª…ìƒ‰ -->
          <div class="color-swatch transparent" data-color="rgba(0,0,0,0)"></div>
          <!-- ë¬´ì±„ìƒ‰ ìŠ¤ì™€ì¹˜ -->
          <div class="color-swatch" data-color="#000000" style="background-color: #000000;"></div>
          <div class="color-swatch" data-color="#333333" style="background-color: #333333;"></div>
          <div class="color-swatch" data-color="#545454" style="background-color: #545454;"></div>
          <div class="color-swatch" data-color="#737373" style="background-color: #737373;"></div>
          <div class="color-swatch" data-color="#A6A6A6" style="background-color: #A6A6A6;"></div>
          <div class="color-swatch" data-color="#D9D9D9" style="background-color: #D9D9D9;"></div>
          <div class="color-swatch" data-color="#FFFFFF" style="background-color: #FFFFFF;"></div>

          <!-- ìƒˆë¡œìš´ ìœ ì±„ìƒ‰ ìŠ¤ì™€ì¹˜ë“¤ -->
          <div class="color-swatch" data-color="#D0021B" style="background-color: #D0021B;"></div>
          <div class="color-swatch" data-color="#F5A623" style="background-color: #F5A623;"></div>
          <div class="color-swatch" data-color="#F8E71C" style="background-color: #F8E71C;"></div>
          <div class="color-swatch" data-color="#8B572A" style="background-color: #8B572A;"></div>
          <div class="color-swatch" data-color="#7ED321" style="background-color: #7ED321;"></div>
          <div class="color-swatch" data-color="#417505" style="background-color: #417505;"></div>
          <div class="color-swatch" data-color="#BD10E0" style="background-color: #BD10E0;"></div>
          <div class="color-swatch" data-color="#4A90E2" style="background-color: #4A90E2;"></div>
          <div class="color-swatch" data-color="#50E3C2" style="background-color: #50E3C2;"></div>
          <div class="color-swatch" data-color="#B8E986" style="background-color: #B8E986;"></div>

          <div class="color-input-area">
            <label for="hexInput" id="directInputLabel">ì§ì ‘ ì…ë ¥:</label>
            <input type="text" id="hexInput" maxlength="7" placeholder="#RRGGBB">
          </div>
        </div>
      </div>
      <button id="eyedropperButton">ìŠ¤í¬ì´ë“œ</button>
    </div>

    <div class="ratio-controls-flex-group">
      <label for="aspectRatio" id="aspectRatioLabel">ë¹„ìœ¨ ì„ íƒ:</label>
      <select id="aspectRatio">
        <option value="1" id="option1_1">1:1</option>
        <option value="1.33" id="option4_3">4:3</option>
        <option value="1.5" id="option3_2">3:2</option>
        <option value="1.78" selected id="option16_9">16:9</option>
        <option value="custom" id="customOption">-- ì§ì ‘ ì…ë ¥ --</option>
      </select>

      <div id="customAspectRatioInputGroup" class="aspect-ratio-custom-input-group">
        <label for="customAspectRatioInput" id="customRatioLabel">ë¹„ìœ¨ ì…ë ¥:</label>
        <input type="text" id="customAspectRatioInput" placeholder="ì˜ˆ: 16:9">
        <small style="display: block; margin-top: 0.2rem; font-size: 0.8rem; color: #aaa;" id="ratioHint">ë¹ˆ ê°’ ì‹œ 16:9 ë¹„ìœ¨ì´ ì ìš©ë©ë‹ˆë‹¤.</small>
      </div>
    </div>

    <button id="downloadButton">ë‹¤ìš´ë¡œë“œ</button>

    <canvas id="canvas" width="1600" height="900"></canvas>
  </div> <!-- âœ¨ ì¶”ê°€: ë©”ì¸ ì½˜í…ì¸  ì»¨í…Œì´ë„ˆ ë âœ¨ -->

  <script>
    let img;
    let originalFileName = '';
    const canvas = document.getElementById("canvas");
    const ctx = canvas.getContext("2d");
    const imageInput = document.getElementById("imageInput");
    const aspectRatioSelect = document.getElementById("aspectRatio");
    const customAspectRatioInput = document.getElementById("customAspectRatioInput");
    const customAspectRatioInputGroup = document.getElementById("customAspectRatioInputGroup");

    const colorDisplayBox = document.getElementById("colorDisplayBox");
    const currentHexSpan = document.getElementById("currentHex");
    const predefinedColorPalette = document.getElementById("predefinedColorPalette");
    const eyedropperButton = document.getElementById("eyedropperButton");
    const hexInput = document.getElementById("hexInput");
    const downloadButton = document.getElementById("downloadButton");

    let currentBgColor = "#000000";

    // âœ¨ êµ­ì œí™” (i18n) ê´€ë ¨ ì½”ë“œ ì¶”ê°€ ì‹œì‘ âœ¨
    const translations = {
        ko: {
            title: "Image Padding Tool",
            mainTitle: "ğŸ“ Image Padding Tool",
            bgColorLabel: "ë°°ê²½ìƒ‰:",
            directInputLabel: "ì§ì ‘ ì…ë ¥:",
            eyedropperButton: "ìŠ¤í¬ì´ë“œ",
            aspectRatioLabel: "ë¹„ìœ¨ ì„ íƒ:",
            option1_1: "1:1",
            option4_3: "4:3",
            option3_2: "3:2",
            option16_9: "16:9",
            customOption: "-- ì§ì ‘ ì…ë ¥ --",
            customRatioPlaceholder: "ì˜ˆ: 16:9",
            ratioHint: "ë¹ˆ ê°’ ì‹œ 16:9 ë¹„ìœ¨ì´ ì ìš©ë©ë‹ˆë‹¤.",
            downloadButton: "ë‹¤ìš´ë¡œë“œ",
            alertNoImage: "ì´ë¯¸ì§€ë¥¼ ë¨¼ì € ì—…ë¡œë“œí•´ì£¼ì„¸ìš”.",
            alertEyedropperNotSupported: "ì´ ë¸Œë¼ìš°ì €ì—ì„œëŠ” ìŠ¤í¬ì´ë“œ ê¸°ëŠ¥ì„ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. (Chrome, Edge ë“±ì—ì„œ ì‚¬ìš© ê°€ëŠ¥)",
            eyedropperButtonTitle: "ì´ ë¸Œë¼ìš°ì €ëŠ” ìŠ¤í¬ì´ë“œ ê¸°ëŠ¥ì„ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.",
            transparent: "íˆ¬ëª…"
        },
        en: {
            title: "Image Padding Tool",
            mainTitle: "ğŸ“ Image Padding Tool",
            bgColorLabel: "Background Color:",
            directInputLabel: "Direct Input:",
            eyedropperButton: "Eyedropper",
            aspectRatioLabel: "Aspect Ratio:",
            option1_1: "1:1",
            option4_3: "4:3",
            option3_2: "3:2",
            option16_9: "16:9",
            customOption: "-- Custom --",
            customRatioPlaceholder: "e.g., 16:9",
            ratioHint: "If empty, 16:9 ratio will be applied.",
            downloadButton: "Download",
            alertNoImage: "Please upload an image first.",
            alertEyedropperNotSupported: "This browser does not support the Eyedropper tool. (Available in Chrome, Edge, etc.)",
            eyedropperButtonTitle: "This browser does not support the eyedropper tool.",
            transparent: "Transparent"
        }
    };

    let langStrings; // í˜„ì¬ ì„ íƒëœ ì–¸ì–´ì˜ ë¬¸ìì—´ì„ ë‹´ì„ ë³€ìˆ˜

    function getBrowserLanguage() {
        const userLang = navigator.language || navigator.userLanguage;
        if (userLang.startsWith('ko')) {
            return 'ko';
        }
        return 'en'; // ê¸°ë³¸ê°’ì€ ì˜ì–´
    }

    function applyTranslations() {
        const lang = getBrowserLanguage();
        langStrings = translations[lang];

        // HTML ìš”ì†Œ í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
        document.title = langStrings.title;
        document.getElementById("mainTitle").textContent = langStrings.mainTitle;
        document.getElementById("bgColorLabel").textContent = langStrings.bgColorLabel;
        document.getElementById("directInputLabel").textContent = langStrings.directInputLabel;
        document.getElementById("eyedropperButton").textContent = langStrings.eyedropperButton;
        document.getElementById("aspectRatioLabel").textContent = langStrings.aspectRatioLabel;
        document.getElementById("downloadButton").textContent = langStrings.downloadButton;
        document.getElementById("customRatioLabel").textContent = langStrings.customRatioLabel;
        document.getElementById("ratioHint").textContent = langStrings.ratioHint;

        // Placeholder ì—…ë°ì´íŠ¸
        // hexInput.placeholderëŠ” transparentë¡œ ë°”ë€” ìˆ˜ ìˆìœ¼ë¯€ë¡œ updateColorDisplayì—ì„œ ì²˜ë¦¬
        customAspectRatioInput.placeholder = langStrings.customRatioPlaceholder;

        // select option í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
        document.getElementById("option1_1").textContent = langStrings.option1_1;
        document.getElementById("option4_3").textContent = langStrings.option4_3;
        document.getElementById("option3_2").textContent = langStrings.option3_2;
        document.getElementById("option16_9").textContent = langStrings.option16_9;
        document.getElementById("customOption").textContent = langStrings.customOption;

        // EyeDropper ë²„íŠ¼ ìƒíƒœ ë° íˆ´íŒ ì—…ë°ì´íŠ¸
        if (!window.EyeDropper) {
            eyedropperButton.disabled = true;
            eyedropperButton.title = langStrings.eyedropperButtonTitle;
        } else {
            eyedropperButton.disabled = false;
            eyedropperButton.title = ''; // ì§€ì›í•˜ë©´ title ì œê±°
        }

        // í˜„ì¬ ë°°ê²½ìƒ‰ í‘œì‹œ ì—…ë°ì´íŠ¸ (ì–¸ì–´ ë³€ê²½ í›„ 'íˆ¬ëª…' í…ìŠ¤íŠ¸ ì¬ì ìš©)
        updateColorDisplay(currentBgColor);
    }
    // âœ¨ êµ­ì œí™” (i18n) ê´€ë ¨ ì½”ë“œ ì¶”ê°€ ë âœ¨

    imageInput.addEventListener("change", e => {
      const reader = new FileReader();
      reader.onload = function (evt) {
        img = new Image();
        img.onload = () => processImage();
        img.src = evt.target.result;
      };
      if (e.target.files && e.target.files[0]) {
        originalFileName = e.target.files[0].name;
      }
      reader.readAsDataURL(e.target.files[0]);
    });

    // ë¹„ìœ¨ ì„ íƒ ë“œë¡­ë‹¤ìš´ ë³€ê²½ ì‹œ
    aspectRatioSelect.addEventListener("change", () => {
        if (aspectRatioSelect.value === 'custom') {
            customAspectRatioInputGroup.classList.add("visible");
            customAspectRatioInput.focus();
        } else {
            customAspectRatioInputGroup.classList.remove("visible");
            customAspectRatioInput.value = '';
            customAspectRatioInput.classList.remove("invalid");
        }
        processImage();
    });

    // ë¹„ìœ¨ ì§ì ‘ ì…ë ¥ í•„ë“œ ë³€ê²½ ì‹œ
    customAspectRatioInput.addEventListener("input", () => {
        processImage();
    });

    colorDisplayBox.addEventListener("click", (e) => {
      e.stopPropagation();
      predefinedColorPalette.classList.toggle("visible");
    });

    document.addEventListener("click", (e) => {
      if (!predefinedColorPalette.contains(e.target) && !colorDisplayBox.contains(e.target) && e.target !== eyedropperButton) {
        predefinedColorPalette.classList.remove("visible");
      }
    });

    predefinedColorPalette.addEventListener("click", (e) => {
      const targetSwatch = e.target.closest(".color-swatch");
      if (targetSwatch) {
        const selectedColor = targetSwatch.dataset.color;
        if (selectedColor) {
          currentBgColor = selectedColor;
          updateColorDisplay(currentBgColor);
          processImage();
          predefinedColorPalette.classList.remove("visible");
        }
      }
    });

    // í—¥ìŠ¤ ì…ë ¥ í•„ë“œ í´ë¦­ ì‹œ ì „ì²´ ì„ íƒ
    hexInput.addEventListener("focus", () => {
        hexInput.select();
    });

    hexInput.addEventListener("input", () => {
        let value = hexInput.value.trim();
        if (value.length > 0 && !value.startsWith('#') && value.toLowerCase() !== 'transparent') {
            value = '#' + value;
        }

        const validHexRegex = /^#([A-Fa-f0-9]{3}){1,2}$/;

        if (validHexRegex.test(value)) {
            currentBgColor = value;
            updateColorDisplay(currentBgColor);
            processImage();
            hexInput.classList.remove("invalid");
        } else if (value.toLowerCase() === 'transparent') {
             currentBgColor = 'rgba(0,0,0,0)';
             updateColorDisplay(currentBgColor);
             hexInput.classList.remove("invalid");
        } else { // ë¹ˆ ë¬¸ìì—´ ë˜ëŠ” ìœ íš¨í•˜ì§€ ì•Šì€ í—¥ìŠ¤ ì½”ë“œ
            hexInput.classList.add("invalid");
        }
    });

    eyedropperButton.addEventListener("click", async () => {
      if (window.EyeDropper) {
        const eyeDropper = new EyeDropper();
        try {
          const result = await eyeDropper.open();
          currentBgColor = result.sRGBHex;
          updateColorDisplay(currentBgColor);
          processImage();
        } catch (e) {
          console.error("EyeDropper API ì—ëŸ¬:", e);
        }
      } else {
        alert(langStrings.alertEyedropperNotSupported); // âœ¨ ë²ˆì—­ëœ í…ìŠ¤íŠ¸ ì‚¬ìš© âœ¨
      }
    });

    // updateColorDisplay í•¨ìˆ˜ ìˆ˜ì •: hexInput.valueë¥¼ í•­ìƒ í˜„ì¬ ìƒ‰ìƒìœ¼ë¡œ ì±„ì›€
    function updateColorDisplay(color) {
      if (color === 'rgba(0,0,0,0)' || color.toLowerCase() === 'transparent') {
          colorDisplayBox.style.backgroundColor = '';
          colorDisplayBox.classList.add('transparent-display-box');
          currentHexSpan.textContent = langStrings.transparent; // âœ¨ ë²ˆì—­ëœ í…ìŠ¤íŠ¸ ì‚¬ìš© âœ¨
          hexInput.value = 'transparent';
          hexInput.placeholder = langStrings.transparent; // âœ¨ ë²ˆì—­ëœ í…ìŠ¤íŠ¸ ì‚¬ìš© âœ¨
      } else {
          colorDisplayBox.classList.remove('transparent-display-box');
          colorDisplayBox.style.backgroundColor = color;
          currentHexSpan.textContent = color.toUpperCase();
          hexInput.value = color.toUpperCase();
          hexInput.placeholder = color.toUpperCase();
      }
      hexInput.classList.remove("invalid");

      if (color === 'rgba(0,0,0,0)' || color.toLowerCase() === 'transparent') {
        currentHexSpan.style.color = '#333';
      } else {
        const hex = color.startsWith('#') ? color.slice(1) : '000000';
        const r = parseInt(hex.substring(0,2), 16);
        const g = parseInt(hex.substring(2,4), 16);
        const b = parseInt(hex.substring(4,6), 16);
        const luminance = (0.299 * r + 0.587 * g + 0.114 * b) / 255;
        currentHexSpan.style.color = (luminance > 0.5) ? '#333' : '#eee';
      }
    }

    // processImage í•¨ìˆ˜ (ë¹„ìœ¨ ê³„ì‚° ë¡œì§ í¬í•¨)
    function processImage() {
      if (!img) return;

      let aspect;
      const selectedRatioOption = aspectRatioSelect.value;
      const customRatioValue = customAspectRatioInput.value.trim();
      const parts = customRatioValue.split(':');

      if (selectedRatioOption === 'custom' && parts.length === 2 && !isNaN(parseFloat(parts[0])) && !isNaN(parseFloat(parts[1])) && parseFloat(parts[1]) !== 0) {
        aspect = parseFloat(parts[0]) / parseFloat(parts[1]);
        customAspectRatioInput.classList.remove("invalid");
      }
      else if (selectedRatioOption === 'custom' && customRatioValue === '') {
        aspect = 16 / 9;
        customAspectRatioInput.classList.remove("invalid");
      }
      else if (selectedRatioOption === 'custom' && customRatioValue !== '') {
        aspect = 16 / 9;
        customAspectRatioInput.classList.add("invalid");
      }
      else {
        aspect = parseFloat(selectedRatioOption || "1.78");
        customAspectRatioInput.classList.remove("invalid");
      }

      const bgColor = currentBgColor;
      const imgRatio = img.width / img.height;
      let canvasWidth, canvasHeight;

      if (imgRatio > aspect) {
        canvasWidth = img.width;
        canvasHeight = Math.round(img.width / aspect);
      } else {
        canvasHeight = img.height;
        canvasWidth = Math.round(img.height * aspect);
      }

      canvas.width = canvasWidth;
      canvas.height = canvasHeight;

      if (bgColor === 'rgba(0,0,0,0)' || bgColor.toLowerCase() === 'transparent') {
        ctx.clearRect(0, 0, canvasWidth, canvasHeight);
        canvas.classList.add('transparent-background-pattern');
      } else {
        canvas.classList.remove('transparent-background-pattern');
        ctx.fillStyle = bgColor;
        ctx.fillRect(0, 0, canvasWidth, canvasHeight);
      }

      const x = (canvasWidth - img.width) / 2;
      const y = (canvasHeight - img.height) / 2;

      ctx.drawImage(img, x, y);
    }

    function download() {
      if (!img) {
        alert(langStrings.alertNoImage); // âœ¨ ë²ˆì—­ëœ í…ìŠ¤íŠ¸ ì‚¬ìš© âœ¨
        return;
      }

      let filename = "padded_image.png";

      if (originalFileName) {
        const lastDotIndex = originalFileName.lastIndexOf('.');
        if (lastDotIndex === -1) {
          filename = `${originalFileName}_padded.png`;
        } else {
          const namePart = originalFileName.substring(0, lastDotIndex);
          const extensionPart = originalFileName.substring(lastDotIndex + 1);
          filename = `${namePart}_padded.${extensionPart}`;
        }
      }

      const link = document.createElement("a");
      link.download = filename;
      link.href = canvas.toDataURL();
      link.click();
    }

    // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸° ì„¤ì •
    // DOMContentLoadedë¥¼ ì‚¬ìš©í•˜ì—¬ HTML ë¡œë“œ í›„ ë²ˆì—­ ì ìš©
    document.addEventListener("DOMContentLoaded", () => {
        applyTranslations(); // âœ¨ í˜ì´ì§€ ë¡œë“œ ì‹œ ë²ˆì—­ ì ìš© âœ¨
        updateColorDisplay(currentBgColor); // ì´ˆê¸° ìƒ‰ìƒ í‘œì‹œ ì—…ë°ì´íŠ¸
        processImage(); // ì´ˆê¸° ì´ë¯¸ì§€ ì²˜ë¦¬ (ì—†ìœ¼ë©´ ì‘ë™ ì•ˆí•¨)
    });

    // ë‹¤ìš´ë¡œë“œ ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
    downloadButton.addEventListener("click", download);

  </script>
</body>
</html>